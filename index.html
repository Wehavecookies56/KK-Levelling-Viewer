<html>
	<head>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300italic,700,700italic">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.4.1/milligram.min.css">
		<style>
			body{
				background-color:#202124;
				color:#FFFFFF;
			}
			table {
				margin: auto;
				width: 50%;
				padding: 10px;
			}
            th {
              background-color:#202124;
              position: sticky;
              top: 0;
            }
            td {
                border-color: #6e6e6e;
            }
		</style>
	</head>
	<body>
		<input type="file" id="file-selector" multiple>
		<table id="output">
			
		</table>
		<script>
            function writeStat(stat,tr){
				if(stat) {
					let plus = true;
					const td = tr.insertCell();
					if(stat <0){
						td.style.color = "red"
						plus = false;
					}
					td.appendChild(document.createTextNode((plus ? "+" : "")+stat))
				} else {
					const td = tr.insertCell();
					td.style.color = "#888"
					td.appendChild(document.createTextNode("N/A"))
				}
			}
			
			function writeStatArray(stat,tr){
				if(stat) {
				    const td = tr.insertCell();
					if(stat <0){
						td.style.color = "red"
						plus = false;
					}
					td.appendChild(document.createTextNode(String(stat).substring(String(stat).indexOf(":") + 1)))
				} else {
					const td = tr.insertCell();
					td.style.color = "#888"
					td.appendChild(document.createTextNode("N/A"))
				}
			}
			
			const fileSelector = document.getElementById('file-selector');
			fileSelector.addEventListener('change', (event) => {
				table = document.getElementById('output');
				table.border = 0;
				table.innerHTML = "";
				const files = event.target.files;
				console.log(files[0].name)
				var fr = new FileReader();
				fr.onload=function(){
					const obj = JSON.parse(fr.result);
                        var thead = table.createTHead();
						const firstHeader = thead.insertRow();
						nameCell = firstHeader.insertCell();
						nameCell.appendChild(document.createTextNode(files[0].name))
						nameCell.colSpan = 9;
						nameCell.style = "font-size:36px; text-align:center;";
						const header = table.insertRow();
						header.insertCell().outerHTML = "<th>Level</th>";
						header.insertCell().outerHTML = "<th>Strength</th>";
						header.insertCell().outerHTML = "<th>Magic</th>";
						header.insertCell().outerHTML = "<th>Defense</th>";
						header.insertCell().outerHTML = "<th>AP</th>";
						header.insertCell().outerHTML = "<th>Max HP</th>";
						header.insertCell().outerHTML = "<th>Max MP</th>";
						header.insertCell().outerHTML = "<th>Abilities</th>";
						header.insertCell().outerHTML = "<th>Shotlocks</th>";

                    var tbody = table.createTBody();
					for (let i = 0; i <= 100; i++) {
						const tr = tbody.insertRow();
						let level = obj[i];
						const td = tr.insertCell();
						td.appendChild(document.createTextNode(i))

						writeStat(level.str,tr)
						writeStat(level.mag,tr)
						writeStat(level.def,tr)
						writeStat(level.ap,tr)
						writeStat(level.maxhp,tr)
						writeStat(level.maxmp,tr)
						writeStatArray(level.abilities,tr)
						writeStatArray(level.shotlocks,tr)
					}
					
				}
				
				fr.readAsText(files[0]);
			  });
		</script>
	</body>
</html>
